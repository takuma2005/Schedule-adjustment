# インストール・使用ガイド

Google Calendar Free Time Finder の詳細なインストール手順と使用方法を説明します。

## 📥 インストール手順

### ステップ 1: プロジェクトの入手

#### 方法A: GitHubからクローン（推奨）
```bash
git clone https://github.com/takuma2005/Schedule-adjustment.git
cd Schedule-adjustment
```

#### 方法B: ZIPファイルのダウンロード
1. [GitHubリポジトリ](https://github.com/takuma2005/Schedule-adjustment)にアクセス
2. 緑色の「Code」ボタンをクリック
3. 「Download ZIP」を選択
4. ダウンロードしたZIPファイルを展開

### ステップ 2: Chrome拡張機能の開発者モード有効化

1. **Chromeを開く**
2. **拡張機能ページにアクセス**
   - アドレスバーに `chrome://extensions/` と入力
   - または、メニュー（⋮）→「拡張機能」→「拡張機能を管理」

3. **開発者モードを有効化**
   - 右上の「デベロッパーモード」のトグルスイッチをONにする
   ![開発者モード有効化](https://developer.chrome.com/static/docs/extensions/get-started/tutorial/hello-world/image/extensions-page-e0d64d89a6acf_1440.png)

### ステップ 3: 拡張機能の読み込み

1. **「パッケージ化されていない拡張機能を読み込む」をクリック**
2. **プロジェクトフォルダを選択**
   - `Schedule-adjustment` フォルダ全体を選択
   - 📁 **重要**: フォルダ内のファイル（manifest.json など）ではなく、フォルダ自体を選択
3. **インストール確認**
   - 拡張機能一覧に「Google Calendar Free Time Finder」が追加される
   - アイコンがChromeのツールバーに表示される

### ステップ 4: 権限の確認

インストール時に以下の権限が要求されます：
- ✅ **アクティブなタブ**: 現在開いているカレンダーページからデータを読み取り
- ✅ **ストレージ**: 設定値の保存

## 🎯 使用方法

### 基本的な使い方

#### 1. Googleカレンダーを開く
- [calendar.google.com](https://calendar.google.com) にアクセス
- Googleアカウントでログイン済みであることを確認

#### 2. 月表示に切り替え
- **重要**: 必ず月表示（Month view）にしてください
- 画面上部の表示切り替えボタンで「月」を選択
- 週表示や日表示では正しく動作しません

#### 3. 空き時間検索の実行
1. **ボタンの確認**: 右上に「空き時間検索」ボタンが表示されるのを確認（数秒かかる場合があります）
2. **ボタンをクリック**: ポップアップウィンドウが開きます
3. **即座に検索**: デフォルト設定で「更新」ボタンを押すと、すぐに結果が表示されます

### 詳細設定のカスタマイズ

#### 設定パネルの開き方
1. ポップアップで「設定」ボタンをクリック
2. 設定項目が展開表示されます

#### 設定項目の詳細

##### 📅 検索期間
- **開始日**: 検索を開始する日付
- **終了日**: 検索を終了する日付
- **推奨設定**: 今日から1週間後まで

##### ⏰ 時間設定
- **開始時刻**: 検索対象時間帯の開始（例: 09:00）
- **終了時刻**: 検索対象時間帯の終了（例: 18:00）
- **用途例**: 
  - 営業時間内のみ検索: 9:00-18:00
  - フレックス対応: 7:00-22:00

##### ⏱️ 時間長設定
- **所要時間**: 必要な時間の長さ（15分刻み）
  - 短い打ち合わせ: 30分
  - 会議: 60分
  - ワークショップ: 120分
- **前後の余裕時間**: バッファ時間
  - 移動時間考慮: 15分
  - 準備時間込み: 30分

##### ☑️ 除外設定
- **終日の予定を予定として含める**: 
  - ✅ チェック有り: 終日予定がある日も検索対象
  - ❌ チェック無し: 終日予定がある日は除外
- **土日を含める**:
  - ✅ チェック有り: 全曜日が検索対象
  - ❌ チェック無し: 平日（月～金）のみ

### 結果の見方・活用

#### 表示形式
```
9月 7日 (月曜日)  09:00-10:30 / 14:00-17:00
9月 8日 (火曜日)  13:00-15:00
9月10日 (木曜日)  10:00-12:00 / 15:30-18:00
```

#### 活用方法
1. **コピー機能**: 「コピー」ボタンで結果をクリップボードに保存
2. **メール添付**: 会議調整メールに結果を貼り付け
3. **選択肢提示**: 複数の候補時間を相手に提示

## ⚠️ トラブルシューティング

### よくある問題と解決方法

#### 問題 1: ボタンが表示されない
**症状**: 右上に「空き時間検索」ボタンが出てこない

**解決方法**:
1. ページを完全に再読み込み（Ctrl+F5 または Cmd+Shift+R）
2. 2-3秒待つ（Google Calendar の読み込み完了を待つ）
3. 月表示になっているか確認
4. 拡張機能が有効になっているか確認（chrome://extensions/）

#### 問題 2: 空き時間が検出されない
**症状**: 「空き時間が見つかりませんでした」と表示される

**解決方法**:
1. **表示モード確認**: 必ず月表示にする
2. **時間設定確認**: 検索時間帯が適切か確認
3. **期間設定確認**: 検索期間内にイベントがあるか確認
4. **所要時間調整**: 必要時間を短くして再検索

#### 問題 3: 時間が正しく解析されない
**症状**: 予定があるのに空き時間として表示される

**原因と対策**:
- **日本語時刻の問題**: 「午前10時」「PM2:00」などの表記確認
- **イベントタイトル**: 時間情報がタイトルに含まれているか確認
- **複数カレンダー**: 別のカレンダーのイベントが認識されない可能性

#### 問題 4: 拡張機能が突然動かなくなった
**原因**: Google Calendar のアップデートによる影響

**対策**:
1. 拡張機能を無効化してから再有効化
2. Chrome を再起動
3. 拡張機能を最新版に更新
4. 問題が続く場合は GitHub Issues で報告

### デバッグ情報の確認方法

開発者向け情報ですが、問題の原因特定に役立ちます：

1. **開発者ツールを開く**: F12 または右クリック → 「検証」
2. **Consoleタブを選択**
3. **実行ログを確認**:
```javascript
カレンダーイベントの取得を開始 (月表示 .XuJrye 専用)
XuJrye候補: 15 個
.XuJryeから 8 件のイベント
[FreeTime Debug] 今日 { ... }
```
4. **エラーがある場合**: 赤色のエラーメッセージをコピーして報告

## 🔧 高度な設定・カスタマイズ

### 設定値の微調整

#### デフォルト値の変更
`content.js` ファイルで以下の値をカスタマイズできます：

```javascript
// デフォルト時間設定
startTime: "09:00"    → お好みの開始時刻
endTime: "20:00"      → お好みの終了時刻
duration: 30          → デフォルト所要時間（分）
bufferTime: 15        → デフォルト余裕時間（分）
```

#### ボタンの見た目変更
`styles.css` ファイルでボタンのスタイルをカスタマイズ：

```css
.free-time-btn {
    background-color: #1976d2;  /* ボタン色 */
    top: 12px;                  /* 位置（上から） */
    right: 12px;                /* 位置（右から） */
}
```

### 更新・メンテナンス

#### 拡張機能の更新方法
1. GitHubから最新版をダウンロード
2. Chrome拡張機能ページで「再読み込み」ボタンをクリック
3. 変更が反映されることを確認

#### バックアップ・復元
設定はブラウザに保存されるため、以下の場合に設定が失われます：
- ブラウザデータの消去
- 拡張機能の削除・再インストール

## 📞 サポート・コミュニティ

### 問い合わせ先
- **GitHub Issues**: バグ報告・機能要求
  - [https://github.com/takuma2005/Schedule-adjustment/issues](https://github.com/takuma2005/Schedule-adjustment/issues)
- **ライセンス**: MIT License（商用・非商用問わず自由に使用可能）

### 貢献方法
- バグ修正・機能追加のPull Request歓迎
- 翻訳・ドキュメント改善
- 使用感のフィードバック

---

🚀 **成功の鍵**: このツールは月表示での使用を前提に設計されています。週表示や日表示では十分な機能を発揮できないため、必ず月表示でご利用ください！
